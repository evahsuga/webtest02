<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ–ãƒ­ã‚°ä½œæˆæ”¯æ´ã‚¢ãƒ—ãƒª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Yu Gothic UI', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: white;
            padding: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        h1 {
            text-align: center;
            color: #2c3e50;
            font-size: 2.5rem;
            font-weight: 300;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .card h2 {
            color: #34495e;
            margin-bottom: 20px;
            font-size: 1.5rem;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #3498db;
        }

        textarea {
            resize: vertical;
            min-height: 120px;
        }

        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        button:hover {
            background: #2980b9;
        }

        button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }

        .outline-section {
            margin-top: 20px;
        }

        .outline-item {
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 0 5px 5px 0;
        }

        .outline-item h3 {
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .outline-item p {
            color: #7f8c8d;
            font-size: 14px;
        }

        .editor {
            grid-column: 1 / -1;
        }

        .editor textarea {
            min-height: 400px;
            font-family: 'Courier New', monospace;
        }

        .hidden {
            display: none;
        }

        .article-list {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            max-height: 400px;
            overflow-y: auto;
        }

        .article-item {
            background: white;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #3498db;
            cursor: pointer;
            transition: all 0.3s;
        }

        .article-item:hover {
            background: #e8f4f8;
            transform: translateX(5px);
        }

        .article-item h4 {
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }

        .article-item .article-date {
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        .article-item .article-preview {
            color: #555;
            font-size: 0.9rem;
            margin-top: 8px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>ãƒ–ãƒ­ã‚°ä½œæˆæ”¯æ´ã‚¢ãƒ—ãƒª</h1>
        </div>
    </header>

    <div class="container">
        <div class="main-content">
            <!-- è©±é¡Œãƒ’ã‚¢ãƒªãƒ³ã‚° -->
            <div class="card" id="topicCard">
                <h2>ğŸ“ è©±é¡Œã‚’ãŠèã‹ã›ãã ã•ã„</h2>
                <div class="form-group">
                    <label for="topic">æ›¸ããŸã„è©±é¡Œãƒ»ãƒ†ãƒ¼ãƒ</label>
                    <input type="text" id="topic" placeholder="ä¾‹ï¼šãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°å­¦ç¿’ã«ã¤ã„ã¦">
                </div>
                <div class="form-group">
                    <label for="referenceUrl">å‚è€ƒè¨˜äº‹URLï¼ˆä»»æ„ï¼‰</label>
                    <input type="url" id="referenceUrl" placeholder="å‚è€ƒã«ã—ãŸã„è¨˜äº‹ã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹ï¼šhttps://example.com/articleï¼‰">
                </div>
                <div class="form-group">
                    <label for="purpose">è¨˜äº‹ã®ç›®çš„</label>
                    <textarea id="purpose" placeholder="ã“ã®è¨˜äº‹ã§èª­è€…ã«ä½•ã‚’ä¼ãˆãŸã„ã‹ã€ã©ã‚“ãªä¾¡å€¤ã‚’æä¾›ã—ãŸã„ã‹ã‚’æ•™ãˆã¦ãã ã•ã„"></textarea>
                </div>
                <div class="form-group">
                    <label for="experience">é–¢é€£ã™ã‚‹çµŒé¨“ãƒ»çŸ¥è­˜</label>
                    <textarea id="experience" placeholder="ã“ã®è©±é¡Œã«é–¢ã™ã‚‹ã‚ãªãŸã®çµŒé¨“ã‚„å°‚é–€çŸ¥è­˜ãŒã‚ã‚Œã°æ•™ãˆã¦ãã ã•ã„"></textarea>
                </div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button onclick="generateOutline()">æ§‹æˆã‚’ææ¡ˆã—ã¦ã‚‚ã‚‰ã†</button>
                    <button onclick="showSavedArticlesList()" style="background: #27ae60;">ğŸ“š ä¿å­˜æ¸ˆã¿è¨˜äº‹ä¸€è¦§</button>
                </div>
                <div id="topArticlesList" class="article-list hidden"></div>
            </div>

            <!-- æ§‹æˆææ¡ˆ -->
            <div class="card" id="outlineCard">
                <h2>ğŸ“‹ è¨˜äº‹æ§‹æˆæ¡ˆ</h2>
                <div id="outlineContent">
                    <p style="color: #7f8c8d; text-align: center; padding: 40px 0;">
                        å·¦å´ã®ãƒ•ã‚©ãƒ¼ãƒ ã«å…¥åŠ›ã—ã¦ã€Œæ§‹æˆã‚’ææ¡ˆã—ã¦ã‚‚ã‚‰ã†ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„
                    </p>
                </div>
                <button onclick="startWriting()" id="startWritingBtn" class="hidden">ã“ã®æ§‹æˆã§è¨˜äº‹ã‚’æ›¸ã</button>
            </div>
        </div>

        <!-- è¨˜äº‹ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ -->
        <div class="card editor hidden" id="editorCard">
            <h2>âœï¸ è¨˜äº‹ã‚’æ›¸ã</h2>
            <div class="form-group">
                <label for="title">è¨˜äº‹ã‚¿ã‚¤ãƒˆãƒ«</label>
                <input type="text" id="title" placeholder="è¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›">
            </div>
            <div class="form-group">
                <label for="content">è¨˜äº‹å†…å®¹ï¼ˆMarkdownå½¢å¼ï¼‰</label>
                <textarea id="content" placeholder="ã“ã“ã«è¨˜äº‹ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚Markdownè¨˜æ³•ãŒä½¿ãˆã¾ã™ã€‚"></textarea>
            </div>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button onclick="saveArticle()">è¨˜äº‹ã‚’ä¿å­˜</button>
                <button onclick="previewArticle()">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
                <button onclick="showSavedArticlesList()">ä¿å­˜æ¸ˆã¿è¨˜äº‹ä¸€è¦§</button>
                <button onclick="loadSavedArticles()" style="background: #27ae60;">è¨˜äº‹ã‚’èª­ã¿è¾¼ã¿</button>
            </div>
            <div id="articlesList" class="article-list hidden"></div>
        </div>
    </div>

    <script>
        // ãƒ–ãƒ­ã‚°æ§‹æˆææ¡ˆæ©Ÿèƒ½
        async function generateOutline() {
            const topic = document.getElementById('topic').value;
            const purpose = document.getElementById('purpose').value;
            const experience = document.getElementById('experience').value;
            const referenceUrl = document.getElementById('referenceUrl').value;

            if (!topic || !purpose) {
                alert('è©±é¡Œãƒ»ãƒ†ãƒ¼ãƒã¨è¨˜äº‹ã®ç›®çš„ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            // å‚è€ƒURLã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å–å¾—
            let referenceContent = '';
            if (referenceUrl) {
                try {
                    const fetchButton = document.querySelector('button[onclick="generateOutline()"]');
                    fetchButton.disabled = true;
                    fetchButton.textContent = 'å‚è€ƒè¨˜äº‹ã‚’èª­ã¿è¾¼ã¿ä¸­...';
                    
                    referenceContent = await fetchReferenceContent(referenceUrl);
                } catch (error) {
                    console.error('å‚è€ƒè¨˜äº‹ã®å–å¾—ã«å¤±æ•—:', error);
                    alert('å‚è€ƒè¨˜äº‹ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚URLã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
                } finally {
                    document.querySelector('button[onclick="generateOutline()"]').disabled = false;
                    document.querySelector('button[onclick="generateOutline()"]').textContent = 'æ§‹æˆã‚’ææ¡ˆã—ã¦ã‚‚ã‚‰ã†';
                }
            }

            // ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹æˆç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ï¼ˆä¸€èˆ¬å‘ã‘ã«å›ºå®šï¼‰
            const outline = generateBlogOutline(topic, 'general', purpose, experience, referenceContent);
            displayOutline(outline);
        }

        // å‚è€ƒè¨˜äº‹ã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å–å¾—ã™ã‚‹é–¢æ•°
        async function fetchReferenceContent(url) {
            // ã‚·ãƒ³ãƒ—ãƒ«ãªURLæ¤œè¨¼
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                throw new Error('æœ‰åŠ¹ãªURLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
            }
            
            // å®Ÿéš›ã®WebFetchæ©Ÿèƒ½ã¯åˆ¶é™ãŒã‚ã‚‹ãŸã‚ã€URLæƒ…å ±ã®ã¿ä¿å­˜
            return `å‚è€ƒè¨˜äº‹URL: ${url}`;
        }

        function generateBlogOutline(topic, target, purpose, experience, referenceContent = '') {
            // å¸¸ã«ä¸€èˆ¬å‘ã‘ã«å›ºå®š
            const targetText = 'ä¸€èˆ¬ã®æ–¹';

            // AIã«ã‚ˆã‚‹ã€Œã¯ã˜ã‚ã«ã€æ–‡ç« ç”Ÿæˆ
            const introText = generateIntroText(topic, 'general', purpose, experience);

            return {
                title: `${targetText}å‘ã‘ï¼š${topic}ã«ã¤ã„ã¦`,
                referenceContent: referenceContent,
                sections: [
                    {
                        title: 'ã¯ã˜ã‚ã«',
                        content: introText
                    },
                    {
                        title: `${topic}ã¨ã¯ï¼Ÿ`,
                        content: 'åŸºæœ¬çš„ãªæ¦‚å¿µã‚„å®šç¾©ã‚’èª¬æ˜'
                    },
                    {
                        title: experience ? 'ç§ã®çµŒé¨“ã‹ã‚‰' : 'å…·ä½“ä¾‹ãƒ»äº‹ä¾‹',
                        content: experience || 'å®Ÿéš›ã®ä¾‹ã‚„äº‹ä¾‹ã‚’ç´¹ä»‹'
                    },
                    {
                        title: 'ãƒã‚¤ãƒ³ãƒˆãƒ»ã‚³ãƒ„',
                        content: 'åŠ¹æœçš„ã«é€²ã‚ã‚‹ãŸã‚ã®ãƒã‚¤ãƒ³ãƒˆ'
                    },
                    {
                        title: 'ã¾ã¨ã‚',
                        content: 'è¨˜äº‹ã®è¦ç‚¹ã‚’ã¾ã¨ã‚ã€èª­è€…ã¸ã®æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ææ¡ˆ'
                    }
                ]
            };
        }

        function displayOutline(outline) {
            const outlineContent = document.getElementById('outlineContent');
            const html = `
                <div class="outline-item">
                    <h3>ğŸ“° ææ¡ˆã‚¿ã‚¤ãƒˆãƒ«</h3>
                    <p>${outline.title}</p>
                </div>
                ${outline.sections.map((section, index) => `
                    <div class="outline-item">
                        <h3>${index + 1}. ${section.title}</h3>
                        <p>${section.content}</p>
                    </div>
                `).join('')}
            `;
            outlineContent.innerHTML = html;
            document.getElementById('startWritingBtn').classList.remove('hidden');
        }

        function startWriting() {
            document.getElementById('editorCard').classList.remove('hidden');
            const title = document.querySelector('.outline-item p').textContent;
            document.getElementById('title').value = title;
            
            // ãƒ’ã‚¢ãƒªãƒ³ã‚°å†…å®¹ã‚’å–å¾—
            const topic = document.getElementById('topic').value;
            const purpose = document.getElementById('purpose').value;
            const experience = document.getElementById('experience').value;
            const referenceUrl = document.getElementById('referenceUrl').value;
            
            // æ§‹æˆã‚’åŸºã«ã—ãŸè¨˜äº‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”Ÿæˆ
            const sections = document.querySelectorAll('.outline-item');
            let template = '';
            
            // ãƒ’ã‚¢ãƒªãƒ³ã‚°å†…å®¹ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦è¨˜äº‹ã®å†’é ­ã«è¿½åŠ 
            template += `<!-- ãƒ’ã‚¢ãƒªãƒ³ã‚°å†…å®¹ -->\n`;
            template += `<!-- è©±é¡Œãƒ»ãƒ†ãƒ¼ãƒ: ${topic} -->\n`;
            template += `<!-- æƒ³å®šèª­è€…: ä¸€èˆ¬ã®æ–¹ -->\n`;
            template += `<!-- è¨˜äº‹ã®ç›®çš„: ${purpose} -->\n`;
            if (experience) {
                template += `<!-- é–¢é€£ã™ã‚‹çµŒé¨“ãƒ»çŸ¥è­˜: ${experience} -->\n`;
            }
            if (referenceUrl) {
                template += `<!-- å‚è€ƒè¨˜äº‹URL: ${referenceUrl} -->\n`;
            }
            template += `\n`;
            
            for (let i = 1; i < sections.length; i++) {
                const sectionTitle = sections[i].querySelector('h3').textContent;
                const sectionContent = sections[i].querySelector('p').textContent;
                
                if (sectionTitle.includes('ã¯ã˜ã‚ã«')) {
                    // ã€Œã¯ã˜ã‚ã«ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã¯ç”Ÿæˆã•ã‚ŒãŸæ–‡ç« ã‚’æŒ¿å…¥
                    template += `## ${sectionTitle}\n\n${sectionContent}\n\n`;
                } else if (sectionTitle.includes('ç§ã®çµŒé¨“ã‹ã‚‰') && experience) {
                    // çµŒé¨“ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã¯ãƒ’ã‚¢ãƒªãƒ³ã‚°å†…å®¹ã‚’ãƒ’ãƒ³ãƒˆã¨ã—ã¦è¿½åŠ 
                    template += `## ${sectionTitle}\n\n<!-- ãƒ’ãƒ³ãƒˆ: ${experience} -->\nï¼ˆä¸Šè¨˜ã®ãƒ’ãƒ³ãƒˆã‚’å‚è€ƒã«ã€å…·ä½“çš„ãªçµŒé¨“è«‡ã‚’æ›¸ã„ã¦ãã ã•ã„ï¼‰\n\n`;
                } else if (sectionTitle.includes('ã¨ã¯ï¼Ÿ') || sectionTitle.includes('ã«ã¤ã„ã¦')) {
                    // åŸºæœ¬èª¬æ˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã¯ãƒ’ã‚¢ãƒªãƒ³ã‚°å†…å®¹ã‚’ãƒ’ãƒ³ãƒˆã¨ã—ã¦è¿½åŠ 
                    let hints = `<!-- ãƒ’ãƒ³ãƒˆ: ${purpose} -->\n`;
                    if (referenceUrl) {
                        hints += `<!-- å‚è€ƒè¨˜äº‹: ${referenceUrl} -->\n`;
                    }
                    template += `## ${sectionTitle}\n\n${hints}ï¼ˆ${topic}ã«ã¤ã„ã¦ã€ä¸€èˆ¬ã®æ–¹å‘ã‘ã«åˆ†ã‹ã‚Šã‚„ã™ãèª¬æ˜ã—ã¦ãã ã•ã„ï¼‰\n\n`;
                } else if (sectionTitle.includes('ã¾ã¨ã‚')) {
                    // ã¾ã¨ã‚ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã¯è¨˜äº‹ã®ç›®çš„ã‚’åæ˜ 
                    template += `## ${sectionTitle}\n\n<!-- ãƒ’ãƒ³ãƒˆ: è¨˜äº‹ã®ç›®çš„ - ${purpose} -->\nï¼ˆè¨˜äº‹ã®è¦ç‚¹ã‚’ã¾ã¨ã‚ã€èª­è€…ã¸ã®æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ææ¡ˆã—ã¦ãã ã•ã„ï¼‰\n\n`;
                } else {
                    // ãã®ä»–ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚‚å‚è€ƒURLãŒã‚ã‚Œã°è¿½åŠ 
                    let hints = '';
                    if (referenceUrl) {
                        hints = `<!-- å‚è€ƒè¨˜äº‹: ${referenceUrl} -->\n`;
                    }
                    template += `## ${sectionTitle}\n\n${hints}ï¼ˆã“ã“ã«å†…å®¹ã‚’æ›¸ã„ã¦ãã ã•ã„ï¼‰\n\n`;
                }
            }
            
            document.getElementById('content').value = template;
            
            // ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
            document.getElementById('editorCard').scrollIntoView({ behavior: 'smooth' });
        }

        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æ©Ÿèƒ½
        function saveArticle() {
            const title = document.getElementById('title').value;
            const content = document.getElementById('content').value;
            
            if (!title || !content) {
                alert('ã‚¿ã‚¤ãƒˆãƒ«ã¨å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            const article = {
                id: Date.now(),
                title: title,
                content: content,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            const savedArticles = JSON.parse(localStorage.getItem('blogArticles') || '[]');
            savedArticles.push(article);
            localStorage.setItem('blogArticles', JSON.stringify(savedArticles));
            
            alert('è¨˜äº‹ãŒä¿å­˜ã•ã‚Œã¾ã—ãŸï¼');
        }

        // AIã«ã‚ˆã‚‹ã€Œã¯ã˜ã‚ã«ã€æ–‡ç« ç”Ÿæˆæ©Ÿèƒ½ï¼ˆä¸€èˆ¬å‘ã‘ã«å›ºå®šï¼‰
        function generateIntroText(topic, target, purpose, experience) {
            const template = [
                `${topic}ã«ã¤ã„ã¦é–¢å¿ƒã‚’ãŠæŒã¡ã®çš†ã•ã‚“ã€ã¯ã˜ã‚ã¾ã—ã¦ã€‚`,
                `ã“ã®è¨˜äº‹ã§ã¯ã€${topic}ã®é­…åŠ›ã‚„é‡è¦æ€§ã«ã¤ã„ã¦ã€èª°ã«ã§ã‚‚ç†è§£ã§ãã‚‹å½¢ã§ãŠä¼ãˆã—ã¾ã™ã€‚`,
                `${purpose}ãŸã‚ã«ã€èº«è¿‘ãªä¾‹ã‚’ç”¨ã„ãªãŒã‚‰åˆ†ã‹ã‚Šã‚„ã™ãè§£èª¬ã—ã¦ã„ãã¾ã™ã€‚`,
                experience ? `å®Ÿä½“é¨“ã«åŸºã¥ãå…·ä½“çš„ãªã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ã‚‚äº¤ãˆã¦ã”ç´¹ä»‹ã—ã¾ã™ã€‚` : `æ—¥å¸¸ç”Ÿæ´»ã¨ã®é–¢é€£æ€§ã‚’é‡è¦–ã—ãŸå†…å®¹ã§ãŠå±Šã‘ã—ã¾ã™ã€‚`
            ];

            return template.join(' ');
        }

        // ä¿å­˜æ¸ˆã¿è¨˜äº‹ä¸€è¦§è¡¨ç¤ºæ©Ÿèƒ½
        function showSavedArticlesList() {
            const savedArticles = JSON.parse(localStorage.getItem('blogArticles') || '[]');
            // TOPãƒšãƒ¼ã‚¸ã‹ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ãƒšãƒ¼ã‚¸ã‹ã‚’åˆ¤å®š
            const articlesList = document.getElementById('topArticlesList') || document.getElementById('articlesList');
            
            if (savedArticles.length === 0) {
                articlesList.innerHTML = '<p style="text-align: center; color: #7f8c8d; padding: 20px;">ä¿å­˜ã•ã‚ŒãŸè¨˜äº‹ãŒã‚ã‚Šã¾ã›ã‚“</p>';
                articlesList.classList.remove('hidden');
                return;
            }

            const listHTML = savedArticles.map((article, index) => {
                const preview = article.content.replace(/#+\s*/g, '').substring(0, 80) + '...';
                return `
                    <div class="article-item" onclick="loadArticleByIndex(${index})">
                        <h4>${article.title}</h4>
                        <div class="article-date">${new Date(article.createdAt).toLocaleDateString('ja-JP')}</div>
                        <div class="article-preview">${preview}</div>
                    </div>
                `;
            }).join('');

            articlesList.innerHTML = `
                <h3 style="margin-bottom: 15px; color: #2c3e50;">ğŸ“š ä¿å­˜æ¸ˆã¿è¨˜äº‹ä¸€è¦§</h3>
                ${listHTML}
                <button onclick="hideArticlesList()" style="margin-top: 15px; background: #95a5a6;">ä¸€è¦§ã‚’é–‰ã˜ã‚‹</button>
            `;
            articlesList.classList.remove('hidden');
        }

        function hideArticlesList() {
            const topList = document.getElementById('topArticlesList');
            const editorList = document.getElementById('articlesList');
            if (topList) topList.classList.add('hidden');
            if (editorList) editorList.classList.add('hidden');
        }

        function loadArticleByIndex(index) {
            try {
                const savedArticles = JSON.parse(localStorage.getItem('blogArticles') || '[]');
                console.log('ä¿å­˜æ¸ˆã¿è¨˜äº‹ãƒ‡ãƒ¼ã‚¿:', savedArticles);
                console.log('é¸æŠã•ã‚ŒãŸã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹:', index);
                
                if (savedArticles[index]) {
                    const article = savedArticles[index];
                    console.log('èª­ã¿è¾¼ã‚€è¨˜äº‹:', article);
                    
                    // ç·¨é›†ç”»é¢ã‚’è¡¨ç¤º
                    const editorCard = document.getElementById('editorCard');
                    if (editorCard) {
                        editorCard.classList.remove('hidden');
                        console.log('ç·¨é›†ç”»é¢ã‚’è¡¨ç¤ºã—ã¾ã—ãŸ');
                    }
                    
                    // è¨˜äº‹å†…å®¹ã‚’ç·¨é›†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è¨­å®š
                    const titleField = document.getElementById('title');
                    const contentField = document.getElementById('content');
                    
                    console.log('ã‚¿ã‚¤ãƒˆãƒ«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰:', titleField);
                    console.log('ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰:', contentField);
                    
                    if (titleField && contentField) {
                        // ç¢ºå®Ÿã«å€¤ã‚’è¨­å®š
                        titleField.value = String(article.title || '');
                        contentField.value = String(article.content || '');
                        
                        console.log('è¨­å®šã•ã‚ŒãŸã‚¿ã‚¤ãƒˆãƒ«:', titleField.value);
                        console.log('è¨­å®šã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„:', contentField.value);
                        
                        // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æœ‰åŠ¹åŒ–
                        titleField.disabled = false;
                        contentField.disabled = false;
                        
                        // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å½“ã¦ã¦ç·¨é›†å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‚’æ˜ç¢ºã«
                        setTimeout(() => {
                            titleField.focus();
                            titleField.select();
                        }, 300);
                    } else {
                        console.error('ç·¨é›†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                        alert('ç·¨é›†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚');
                        return;
                    }
                    
                    // ä¸€è¦§ã‚’éè¡¨ç¤º
                    hideArticlesList();
                    
                    // ç·¨é›†ç”»é¢ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
                    setTimeout(() => {
                        if (editorCard) {
                            editorCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }, 400);
                    
                    alert(`ã€Œ${article.title}ã€ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸã€‚ç·¨é›†ã—ã¦ãã ã•ã„ã€‚`);
                } else {
                    console.error('è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹:', index);
                    alert('é¸æŠã•ã‚ŒãŸè¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                }
            } catch (error) {
                console.error('è¨˜äº‹èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                alert('è¨˜äº‹ã®èª­ã¿è¾¼ã¿ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);
            }
        }

        function loadSavedArticles() {
            const savedArticles = JSON.parse(localStorage.getItem('blogArticles') || '[]');
            if (savedArticles.length === 0) {
                alert('ä¿å­˜ã•ã‚ŒãŸè¨˜äº‹ãŒã‚ã‚Šã¾ã›ã‚“');
                return;
            }

            const articleList = savedArticles.map((article, index) => 
                `${index + 1}. ${article.title} (${new Date(article.createdAt).toLocaleDateString('ja-JP')})`
            ).join('\n');
            
            const selection = prompt(`ä¿å­˜æ¸ˆã¿è¨˜äº‹:\n${articleList}\n\nèª­ã¿è¾¼ã¿ãŸã„è¨˜äº‹ã®ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ (1-${savedArticles.length})`);
            
            if (selection && !isNaN(selection) && selection >= 1 && selection <= savedArticles.length) {
                const selectedArticle = savedArticles[selection - 1];
                document.getElementById('title').value = selectedArticle.title;
                document.getElementById('content').value = selectedArticle.content;
                alert(`ã€Œ${selectedArticle.title}ã€ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`);
            }
        }

        function previewArticle() {
            const title = document.getElementById('title').value;
            const content = document.getElementById('content').value;
            
            if (!title || !content) {
                alert('ã‚¿ã‚¤ãƒˆãƒ«ã¨å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }

            const previewWindow = window.open('', '_blank');
            previewWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>${title}</title>
                    <style>
                        body { font-family: 'Hiragino Sans', sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
                        h1, h2, h3 { color: #2c3e50; }
                        pre { background: #f4f4f4; padding: 15px; border-radius: 5px; }
                        code { background: #f4f4f4; padding: 2px 4px; border-radius: 3px; }
                    </style>
                </head>
                <body>
                    <h1>${title}</h1>
                    <div>${content.replace(/\n/g, '<br>')}</div>
                </body>
                </html>
            `);
        }
    </script>
</body>
</html>